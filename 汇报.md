## 汇报

#####  pixhawk4代飞控硬件组成介绍

![image-20201030063229247](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201030063229247.png)![image-20201030064305033](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201030064305033.png)![image-20201030064324248](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201030064324248.png)

- Main FMU Processor: STM32F765
  - 32 Bit Arm® Cortex®-M7, 216MHz, 2MB memory, 512KB RAM
- IO Processor: STM32F100
  - 32 Bit Arm® Cortex®-M3, 24MHz, 8KB SRAM
- On-board sensors:
  - Accel/Gyro: ICM-20689
  - Accel/Gyro: BMI055
  - Magnetometer: IST8310
  - Barometer: MS5611
- GPS: ublox Neo-M8N GPS/GLONASS receiver; integrated magnetometer IST8310
- Interfaces:
  - 8-16 PWM outputs (8 from IO, 8 from FMU)
  - 3 dedicated PWM/Capture inputs on FMU
  - Dedicated R/C input for CPPM
  - Dedicated R/C input for Spektrum / DSM and S.Bus with analog / PWM RSSI input
  - Dedicated S.Bus servo output
  - 5 general purpose serial ports
  - 3 I2C ports
  - 4 SPI buses
  - Up to 2 CANBuses for dual CAN with serial ESC
  - Analog inputs for voltage / current of 2 batteries
- Power System:
  - Power module output: 4.9~5.5V
  - USB Power Input: 4.75~5.25V
  - Servo Rail Input: 0~36V
- Other Characteristics:
  - Operating temperature: -40 ~ 85°c

### **多旋翼无人机PID调参**



![image-20201030102313718](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201030102313718.png)

​                                                                                                                                                       

主要是针对姿态环去做的。

​         姿态环采用双闭环PID控制，其外环为角度控制，角度值是由滤波与姿态解算后得到的欧拉角，有延迟且存在误差，所以单纯的单闭环无法实现姿态控制过程。所以需要引入内环，内环选择角速度（rate）控制，角速度由陀螺仪直接测量得到，误差小，响应快，延迟短。整个控制系统外环选择纯比例控制，没有I，D，所以参数只有三个方向的P；内环选择PID控制器，参数有P，I，D三个量。

### 姿态控制框架

![image-20201030104243562](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201030104243562.png)

外环：作用于角度差,产生期望的角速度

![image-20201030104414896](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201030104414896.png)

内环：作用于角速度差，产生控制量

![image-20201030104452859](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201030104452859.png)

控制量 4 个，合力以及三个翻转的力矩。合力决定每个电机的基础转速，在此基础上叠上姿态，最终产生每个电机的转速。即经过混控器求出每个电机转速大小

![image-20201030105255188](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201030105255188.png)

实现姿态稳定。

   

# COEX 项目

 该平台搭载Pixhawk 4代 飞行控制器，[Raspberry Pi 4](https://clover.coex.tech/en/raspberry.html)作为控制板载计算机，以及用于使用计算机视觉进行飞行的[摄像头模块](https://clover.coex.tech/en/camera.html)，以及一组各种传感器组成。

<video src="E:\ev录屏\coex.mp4"></video>

#### 人体姿态估计无人机控制

这个项目是通过普通摄像机前的人的姿势来控制无人机，而无需外部硬件或对计算机的硬性依赖。主控制器使用的是树莓派4。



![image-20201030112238876](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201030112238876.png)

过程：

- 首先，人物应该对摄像机可见，最好是没有很多细节的清晰背景。

- 其次，应按照下图所述进行初始姿势。

- 可以执行任何姿势并尝试保持姿势，直到无人机完成与该姿势相对应的移动为止。

- 完成姿势后，返回到初始姿势，以便向无人机发出命令以收听其他姿势。

- 如果要停止程序，请降落无人机，不要返回初始姿势，然后按Ctrl + C来停止无人机。

- ![image-20201030112719352](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201030112719352.png)

  使用了tensorflow.js的posenet作为我们的人体姿势估计模块，更易于使用，构建，快速且与不同环境（硬件和操作系统）兼容。

<video src="E:\ev录屏\人体姿态估计.mp4"></video>

#### 圆形穿越



<video src="G:\Screencast 2020-10-30 12_05_02.mp4"></video>

颜色巡检。